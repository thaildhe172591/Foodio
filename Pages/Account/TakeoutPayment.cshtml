@page
@model FoodieAPII.Pages.Account.TakeoutPaymentModel
@{
    ViewData["HideLayoutHeader"] = true;

}



<div class="sticky-top bg-white shadow-sm" style="z-index:1030;">
    <div class="container sticky-top bd-white">
        <div class="header">
            <img src="~/images/logo_foddie.jpg" alt="GrabFood Logo" style="height: 80px;">

            <div class="header-search-button d-flex align-items-center gap-3">

                <a href="/Account/User">
                    <div class="d-flex flex-column align-items-center">
                        <i class="bi bi-person-circle text-dark" style="font-size: 30px;"></i>
                        <div class="fw-semibold text-dark mt-1">Nguyễn Văn A</div>
                    </div>
                </a>
            </div>
        </div>

    </div>
</div>
<style>
    .header {
        position: sticky;
        top: 0;
        z-index: 1000;
        background-color: #fff;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 24px;
    }

        .header img {
            margin-right: 20px;
            border-radius: 8px;
        }

    .btn-warning {
        background: linear-gradient(90deg, #ffbf2f, #ff9e3e);
        color: #222;
        font-weight: 600;
        border: none;
    }

        .btn-warning:hover {
            background: linear-gradient(90deg, #ffc107, #ff8800);
            color: white;
        }

    .btn-add-to-cart-custom {
        background: linear-gradient(90deg, #ffbf2f, #ff9e3e);
        color: #222;
        border: none;
        border-radius: 22px;
        font-weight: 600;
        font-size: 14px;
        padding: 10px 20px;
        box-shadow: 0 3px 12px 0 rgba(255, 190, 50, 0.13);
        display: flex;
        justify-content: center; /* thêm dòng này để căn giữa */
        align-items: center;
        transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.18s;
        text-decoration: none;
        width: 100%;
    }


        .btn-add-to-cart-custom:hover {
            background: linear-gradient(90deg, #ffc107, #ff8800);
            color: #fff !important;
            box-shadow: 0 6px 20px 0 rgba(255, 180, 30, 0.18);
            transform: translateY(-2px) scale(1.04);
            text-decoration: none;
        }
</style>

<div class="container mt-5">
    <div class="bg-white p-4 rounded shadow mx-auto" style="max-width: 500px;">
        <h2 class="mb-4 text-center">Thông Tin Giao Hàng</h2>

        <form>
            <div class="mb-3">
                <label class="form-label">Loại đơn</label>
                <div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="orderType" id="delivery" value="672e29b5-bd2c-4008-9117-d077cc9585d5" checked>
                        <label class="form-check-label" for="delivery">Giao hàng</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="orderType" id="pickup" value="450ace82-44ca-4179-9c1f-dffb3115c52d">
                        <label class="form-check-label" for="pickup">Mang về</label>
                    </div>
                </div>
            </div>

            <div class="mb-3">
                <label for="address" class="form-label">Địa chỉ</label>
                <input type="text" class="form-control" id="address" placeholder="123 Đường A, Quận B">
            </div>

            <div class="mb-3">
                <label for="phone" class="form-label">Số điện thoại</label>
                <input type="text" class="form-control" id="phone" placeholder="0123 456 789">
            </div>

            <div class="mb-3">
                <label for="note" class="form-label">Ghi chú</label>
                <textarea class="form-control" id="note" rows="3" placeholder="VD: Giao trước 11h, không lấy ớt..."></textarea>
            </div>

            <button type="button" id="confirm-btn" class="btn btn-add-to-cart-custom w-100">Xác nhận</button>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('confirm-btn').addEventListener('click', function () {
            const orderType = document.querySelector('input[name="orderType"]:checked').value;
            const address = document.getElementById('address').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const note = document.getElementById('note').value.trim();

            // Có thể thêm kiểm tra dữ liệu ở đây nếu cần

            const deliveryInfo = {
                orderType,
                address,
                phone,
                note
            };

            localStorage.setItem('deliveryInfo', JSON.stringify(deliveryInfo));

            // Điều hướng sau khi lưu
            window.location.href = '/Account/ConfirmBill';
        });
    });
    document.addEventListener("DOMContentLoaded", function () {
        const cart = localStorage.getItem("shoppingCart");
        if (!cart || Object.keys(JSON.parse(cart)).length === 0) {
            // Nếu giỏ hàng rỗng hoặc không có
            window.location.href = "/Account/HomePageLogin";
            return;
        }

        // Các xử lý khác ở đây...
    });
      document.addEventListener('DOMContentLoaded', function () {
        // 1. Kiểm tra giỏ hàng
        const cart = localStorage.getItem("shoppingCart");
        if (!cart || Object.keys(JSON.parse(cart)).length === 0) {
            window.location.href = "/Account/HomePageLogin";
            return;
        }

        // 2. Nếu đã lưu thông tin giao hàng trước đó, điền vào form
        const savedInfo = localStorage.getItem("deliveryInfo");
        if (savedInfo) {
            try {
                const info = JSON.parse(savedInfo);
                if (info.address) document.getElementById('address').value = info.address;
                if (info.phone) document.getElementById('phone').value = info.phone;
                if (info.note) document.getElementById('note').value = info.note;

                // Check radio tương ứng với orderType ID
                if (info.orderType) {
                    const radio = document.querySelector(`input[name="orderType"][value="${info.orderType}"]`);
                    if (radio) radio.checked = true;
                }
            } catch (e) {
                console.warn("Không thể parse deliveryInfo:", e);
            }
        }

        // 3. Xác nhận và lưu lại localStorage
        document.getElementById('confirm-btn').addEventListener('click', function () {
            const orderType = document.querySelector('input[name="orderType"]:checked').value;
            const address = document.getElementById('address').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const note = document.getElementById('note').value.trim();

            const deliveryInfo = { orderType, address, phone, note };
            localStorage.setItem('deliveryInfo', JSON.stringify(deliveryInfo));

            window.location.href = '/Account/ConfirmBill';
        });
    });
</script>

